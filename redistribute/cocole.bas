1PCLEAR1:ONBRKGOTO1000:HSCREEN2:PALETTE0,0:PALETTE1,63:PALETTE2,22:PALETTE3,54:PALETTE4,7:PALETTE5,31:HBUFF1,1280:HGET(0,0)-(300,7),1
10HCLS0:HCOLOR5:HPRINT(0,0),"COCOLe":R=RND(-TIMER):OPEN"R",#1,"GUESS.TXT",5:FIELD#1,5AS R$:N=LOF(1):R=RND(N):GET#1,R:W$=R$:CLOSE1:HCOLOR1:FORY=8TO18STEP2:FORX=15TO23STEP2:HLINE(X*8-3,Y*8-3)-(X*8+9,Y*8+9),PSET,B
11NEXTX:NEXTY:HCOLOR5:G=1
60GOSUB6000:R=4:GOSUB4000:IFLEN(G$)<>5 THENM$="That is not a valid word" ELSEGOSUB2000
61IFM$<>"" THENHPRINT(0,4),M$:GOTO60
62FORI=1TO5:C1$=MID$(G$,I,1):C=4:FORJ=1TO5:C2$=MID$(W$,J,1):IFC2$=C1$AND I=J THENC=2
63IFC2$=C1$AND I<>J THENC=3
64NEXTJ:X=I*2+13:Y=G*2+6:HCOLORC:HLINE(X*8-2,Y*8-2)-(X*8+8,Y*8+8),PSET,BF:HCOLOR0:HPRINT(X,Y),C1$:NEXTI:HCOLOR5:IFG$=W$ THENM$="You won in"+STR$(G)+" guesses!":HPRINT(10,21),M$:GOSUB5000:GOTO10
65IFG=6 THENHPRINT(6,21),"You did not guess correctly":GOSUB5000:GOTO10
66G=G+1:GOTO60
1000POKE&H71,0:EXEC&H8C1B
2000F$="GUESS.TXT":GOSUB3000:IFM$<>"" THENF$="WORDS.TXT":GOSUB3000
2001RETURN
3000M$="":OPEN"R",#1,F$,5:FIELD#1,5AS R$:LO=1:HI=LOF(1)
3010R=LO+INT((HI-LO)/2):GET#1,R:IFG$=R$ THENCLOSE1:RETURN
3011IFG$>R$ THENLO=R+1
3012IFG$<R$ THENHI=R
3013IFLO<>HI THENGOTO3010
3014CLOSE1:M$="That is not a valid word":RETURN
4000HPUT(0,R*8)-(300,R*8+7),1,PSET:RETURN
5000LM=17:I=LM*8:HPUT(I,0)-(I+(6*8),7),1,PSET:HPRINT(6,23),"Press any key to play again":EXEC&HADFB:RETURN
6000G$="":LM=17:I=LM*8:HPUT(I,0)-(I+(6*8),7),1,PSET
6010EXEC&HADFB:C$=INKEY$:C=ASC(C$):IFC>=ASC("A")AND LEN(G$)<5 THENG$=G$+C$
6011N=LEN(G$):IFC=8AND N>0 THENN=N-1:G$=LEFT$(G$,N):I=(LM+N)*8:HPUT(I,0)-(I+8,7),1,PSET
6012IFC=13 THENRETURN
6013I=LM*8+N:IFLEN(G$)>0 THENHPRINT(LM,0),G$
6014GOTO6010
